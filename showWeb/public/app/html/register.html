<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0">
  <meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
  <title>注册页</title>
  <link rel="stylesheet" type="text/css" href="../css/api.css"/>
  <link rel="stylesheet" type="text/css" href="../css/Hui.css"/>
  <link rel="stylesheet" type="text/css" href="../css/css.css"/>
</head>
<body>
  <div id="wrap">
      <header class="header1">
        <div class="back">
          <img src="../image/back2.png">
        </div>           
      </header>   
    <div id="main" class="pass_con">
        <div class="pass_set">请输入你的手机号</div>
        <div class="telephone">
          <span class="">+86
            <em class="H-t-border">|</em>
          </span>
          <input id="mobile" type="text" class="pass_text" placeholder="请输入手机号">
        </div>  
        <div id="show" class=" H-width-100-percent H-text-align-center H-font-color-e H-position-fixed H-font-size-16"> 
        </div>
        <div class="button-submit btn" style="margin-top: 11%">
          <button class="submit H-width-100-percent">注册</button>
        </div> 
        <div class="r_agree">
          <p>
            轻触上面的“注册”按钮，即表示你同意<br>
            <span>《映秀直播软件许可及用户协议》</span>
          </p>
        </div>
  </div>
  <script type="text/javascript" src="../script/api.js"></script>
  <script type="text/javascript" src="../script/H.js"></script>
  <script src="../script/jquery-1.8.3.min.js"></script>
  <script type="text/javascript" src="../script/click.js"></script>   
  <script type="text/javascript">
    // apiready = function(){
              
    // };
    // function opencertification2() {
    //   api.openWin({
    //     name:'opencertification2',
    //     url:'opencertification2.html'
    //   })
    // }

    window.onload = function() {
      var back = document.getElementsByClassName('back')[0];
      var buttonsubmit = document.getElementsByClassName('button-submit')[0];

      back.addEventListener('touchstart', function(event) {
        H.openWin('login','login.html');
      },false);

//    buttonsubmit.addEventListener('touchstart', function(event) {
//      H.openWin('code','code.html');
//    },false);
      var mobile = document.getElementById("mobile");
      var show = document.getElementById("show");
      
      mobile.onblur = function() {
        var reg = /^1(3|4|5|7|8)\d{9}$/;
        if(!reg.test(mobile.value)){
          mobile.value = "电话号码有误，请重新输入";
          setTimeout(function(){
            mobile.value = '';
          },2000);
        }else {
          var userInfo = {}; 
        buttonsubmit.onclick = function() {
            userInfo.mobile = mobile.value;
            $.ajax({
              type:"post",
              url:"/app/html/userInfo",
              async:true,
              dataType:'json',
              data:userInfo
            }).success(function(data) {
              var dd = JSON.parse(data);
              if(dd == 11) {
                window.location.href = 'password2.html?id=' + mobile.value;
              }
              if(dd == 22) {
//                show.style.display = 'block';
                show.innerHTML = '该用户已注册，请重新输入!';
                setTimeout(function(){
                  show.innerHTML = '';
                },2000);
              }
          });
            
        }
        }
      }
    }     
  </script>
</body>
</html>